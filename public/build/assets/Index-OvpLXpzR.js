import{W as D,r as c,j as e,R as M,Y as T}from"./app-Dkk80x56.js";import{r as s}from"./index-CAoa_Lfd.js";import{A}from"./AuthenticatedLayout-BGV4sc3p.js";import{I as v}from"./InputError-B4DMRjhS.js";import{F as B,a as L}from"./TrashIcon-CfRVNdQ-.js";import{F as R,a as I}from"./PlusIcon-DqfJkVix.js";import{F as z,a as $,b as P}from"./XCircleIcon-DVdkaKpr.js";const O=({open:m,onClose:i,onSuccess:u,currentSubject:r})=>{const o=!!r,{data:a,setData:x,post:p,reset:g,errors:l,put:N}=D({id:null,title:"",description:"",status:"",cover:null}),[j,h]=c.useState(!1);c.useEffect(()=>{o?x({id:r.id,title:r.title,description:r.description,status:r.status,cover:null}):g()},[r,o]);const b=n=>{n.preventDefault(),h(!0);const d=new FormData;d.append("id",a.id),d.append("title",a.title),d.append("status",a.status),d.append("description",a.description),a.cover&&d.append("cover",a.cover),o?p(route("subjects.update",r.id),{data:d,onSuccess:()=>{h(!1),u("Materia actualizada correctamente."),i()},onError:f=>{console.error(f),h(!1)}}):p(route("subjects.store"),{data:d,onSuccess:()=>{h(!1),g(),u("Materia creada correctamente."),i()},onError:f=>{console.error(f),h(!1)}})};return e.jsx(M.Fragment,{children:e.jsxs(s.Drawer,{placement:"right",open:m,onClose:i,className:"p-4",size:500,children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx("h3",{className:"text-lg font-bold",children:o?"Editar Materia":"Agregar Nueva Materia"}),e.jsx(s.IconButton,{variant:"text",color:"blue-gray",onClick:i,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 h-[calc(100vh-100px)] overflow-y-auto",children:e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s.Input,{id:"title",name:"title",value:a.title,type:"text",size:"lg",label:"Nombre",placeholder:"Nombre",className:"!border-t-blue-gray-200 focus:!border-t-gray-900",labelProps:{className:"before:content-none after:content-none"},onChange:n=>x("title",n.target.value)}),l.title&&e.jsx(v,{message:l.title,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s.Textarea,{id:"description",name:"description",value:a.description,size:"lg",placeholder:"Descripción",className:"!border-t-blue-gray-200 focus:!border-t-gray-900",labelProps:{className:"before:content-none after:content-none"},onChange:n=>x("description",n.target.value)}),l.description&&e.jsx(v,{message:l.description,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"cover",className:"block text-sm font-medium text-gray-700 mb-2",children:"Agrega una imagen para portada de la materia (.jpg)"}),e.jsx("input",{type:"file",id:"cover",name:"cover",accept:".jpg,.jpeg",onChange:n=>x("cover",n.target.files[0])}),l.cover&&e.jsx(v,{message:l.cover,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700",children:"Estado"}),e.jsxs("select",{id:"status",name:"status",value:a.status,onChange:n=>x("status",n.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-blue-gray-200 focus:border-gray-900 focus:outline-none focus:ring-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"Seleccione"}),e.jsx("option",{value:"active",children:"Activa"}),e.jsx("option",{value:"inactive",children:"Inactiva"})]}),l.status&&e.jsx(v,{message:l.status,className:"mt-2"})]}),e.jsx(s.Button,{type:"submit",color:"blue-gray",fullWidth:!0,disabled:j,children:j?"Enviando...":o?"Actualizar Materia":"Crear Materia"})]})})]})})},W=({subjects:m})=>{const[i,u]=c.useState(""),[r,o]=c.useState(m),[a,x]=c.useState(1),[p]=c.useState(5),[g,l]=c.useState(!1),[N,j]=c.useState(null),[h,b]=c.useState(null);c.useEffect(()=>{const t=m.filter(w=>w.title.toLowerCase().includes(i.toLowerCase()));o(t)},[i,m]);const n=a*p,d=n-p,f=r.slice(d,n),y=t=>x(t),S=()=>l(!0),C=()=>{b(null),l(!1)},F=t=>{j(t),setTimeout(()=>j(null),3e3)},k=t=>{b(t),l(!0)};return e.jsxs(e.Fragment,{children:[N&&e.jsx(s.Alert,{color:"green",children:N}),e.jsxs(s.Card,{className:"h-full w-full",children:[e.jsx(s.CardHeader,{floated:!1,shadow:!1,className:"rounded-none",children:e.jsxs("div",{className:"mb-4 flex flex-col justify-between gap-8 md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx(s.Typography,{variant:"h5",color:"blue-gray",children:"Lista de Materias"}),e.jsx(s.Typography,{color:"gray",className:"mt-1 font-normal",children:"Administra tus materias a continuación"})]}),e.jsxs("div",{className:"flex w-full shrink-0 gap-2 md:w-max",children:[e.jsx("div",{className:"w-full md:w-72",children:e.jsx(s.Input,{label:"Buscar nombre",icon:e.jsx(B,{className:"h-5 w-5"}),value:i,onChange:t=>u(t.target.value)})}),e.jsxs(s.Button,{className:"flex items-center gap-3",size:"sm",onClick:S,children:[e.jsx(R,{strokeWidth:2,className:"h-4 w-4"})," Nuevo"]})]})]})}),e.jsx(s.CardBody,{className:"overflow-scroll px-0",children:e.jsxs("table",{className:"w-full min-w-max table-auto text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-4",children:"Título"}),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-4",children:"Descripción"}),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-4",children:"Estado"}),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-4",children:"Acciones"})]})}),e.jsx("tbody",{children:f.map((t,w)=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(s.Typography,{className:"font-bold",children:t.title})})}),e.jsx("td",{className:"p-4",children:t.description}),e.jsx("td",{className:"p-4",children:t.status==="active"?e.jsx(z,{className:"h-4 w-4 text-green-500"}):e.jsx($,{className:"h-4 w-4 text-red-500"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(s.Tooltip,{content:"Editar",children:e.jsx(s.IconButton,{variant:"text",onClick:()=>k(t),children:e.jsx(I,{className:"h-4 w-4"})})}),e.jsx(s.Tooltip,{content:"Lecciones",children:e.jsx(s.IconButton,{variant:"text",onClick:()=>window.location.href=route("lessons.index",t.id),children:e.jsx(P,{className:"h-4 w-4"})})}),e.jsxs("form",{method:"POST",action:route("subjects.destroy",t.id),onSubmit:E=>{window.confirm(`¿Estás seguro que deseas eliminar la materia: ${t.title}?`)||E.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"_token",value:document.querySelector('meta[name="csrf-token"]').getAttribute("content")}),e.jsx("input",{type:"hidden",name:"_method",value:"DELETE"}),e.jsx(s.Tooltip,{content:"Eliminar",children:e.jsx(s.IconButton,{type:"submit",variant:"text",color:"red",children:e.jsx(L,{className:"h-4 w-4"})})})]})]})})]},t.id))})]})}),e.jsxs(s.CardFooter,{className:"flex items-center justify-between border-t border-blue-gray-50 p-4",children:[e.jsx(s.Button,{variant:"outlined",size:"sm",onClick:()=>y(a-1),disabled:a===1,children:"Anterior"}),e.jsx(s.Button,{variant:"outlined",size:"sm",onClick:()=>y(a+1),disabled:a===Math.ceil(r.length/p),children:"Siguiente"})]})]}),e.jsx(O,{open:g,onClose:C,onSuccess:F,currentSubject:h})]})},q=W;function U({auth:m,subjects:i,...u}){var o;const r=(o=u==null?void 0:u.flash)==null?void 0:o.success;return e.jsxs(A,{user:m.user,roles:m.roles,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Materias"}),children:[e.jsx(T,{title:"Subjects"}),e.jsx("div",{children:r&&e.jsx(s.Alert,{color:"green",children:r})}),e.jsx("div",{className:"mt-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:e.jsx(q,{subjects:i})})})]})}export{U as default};
